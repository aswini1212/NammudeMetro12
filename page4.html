<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>page4</title>
    <link
     rel="stylesheet";
     href="./page4.css";
     />
     <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Calistoga&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bubbler+One&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&family=Bungee+Shade&display=swap" rel="stylesheet">
</head>
<body>
    <h1 class="evide">Evide Ponam?</h1>


    <label class="from" for="fname">From</label>
    <select  id="fname" name="fname">
        <option value="Aluva">Aluva</option>
        <option value="Pulinchodu">Pulinchodu</option>  
        <option value="Companypady">Companypady</option>
        <option value="Ambattukavu">Ambattukavu</option>  
        <option value="Muttom">Muttom</option>  
        <option value="Kalamassery">Kalamassery</option>
        <option value="Cusat">Cusat</option>
        <option value="Pathadipalam">Pathadipalam</option>
        <option value="Edapally">Edapally</option>
        <option value="Changampuzha Park">Changampuzha Park</option>
        <option value="Palarivattom">Palarivattom</option>
    </select>    

    <label class="to" for="pass">To</label>
    <select id="pass" name="pass">
        <option value="Aluva">Aluva</option>
        <option value="Pulinchodu">Pulinchodu</option>  
        <option value="Companypady">Companypady</option>
        <option value="Ambattukavu">Ambattukavu</option>  
        <option value="Muttom">Muttom</option>  
        <option value="Kalamassery">Kalamassery</option>
        <option value="Cusat">Cusat</option>
        <option value="Pathadipalam">Pathadipalam</option>
        <option value="Edapally">Edapally</option>
        <option value="Changampuzha Park">Changampuzha Park</option>
        <option value="Palarivattom">Palarivattom</option>  
    </select>    

    <div class="ok">
        <h3 id="okbtn">OK</h3>
    </div>

    <footer>
        <p><span class="nammude">nammude</span><br><span class="metro">METRO</span></p>
    </footer>

    <div id="one"></div>
    <div id="two"></div>
    <div id="three"></div>
    <div id="four"></div>
    <div id="five"></div>
    <div id="six"></div>
    <div id="seven"></div>
    <div id="eight"></div>
    <div id="nine"></div>
    <div id="ten"></div>
    <div id="eleven"></div>
    <div id="twelve"></div>
    <div id="thirteen"></div>
    <div id="fourteen"></div>

    <script type="module" crossorigin="anonymous">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'
        
        const supabaseUrl = 'https://wgcxytmughpalnsczopw.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnY3h5dG11Z2hwYWxuc2N6b3B3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk1ODI2MjYsImV4cCI6MjA2NTE1ODYyNn0.JguujSgFaxLWuYfuIOWV5sgA9MwJGgLLjtwM-DkebPw';
        const supabase = createClient(supabaseUrl, supabaseAnonKey);

        document.getElementById('okbtn').addEventListener('click', async () => {
            const start = document.getElementById('fname').value;
            const end = document.getElementById('pass').value;
        
            const { data, error } = await supabase
                .from('Fares')
                .select("*")
                .eq("Start_des", start)
                .eq("End_des", end);

            if (error) {
                console.error('Error fetching fare:', error.message);
                alert('Error: ' + error.message);
            } else if (data.length > 0) { 
                const price = data[0].Price;
                console.log('Fare found:', price);
                
                // Store the price in local storage
                localStorage.setItem('fare_price', price);
                localStorage.setItem('from', start);
                localStorage.setItem('to', end);
                
                // Redirect to another page if necessary
                //window.location.href = './page5.html';
                window.location.replace('page5.html');
            } else {
                alert('No fare found for the selected route.');
            }
        });
    </script>
            
</body>
</html>
